/*
	UpdateBlobSYMTransaction.sql

	Michael McRae
	July 11, 2014

	Be sure to only run this once a day. It's baasically just a copy/slow build of all Transactions sent from SYM. Except...
	I include a CATEGORY field to specify a Loan transaction or a Share transaction. This Table will also contain all comments which is nice because
	currently I'm just ignoring those when I load Hub_Transaction
*/

INSERT INTO sym_vault1.Blob_SYM_Transaction(PARENTACCOUNT,
 PARENTID, CATEGORY,
 BALSEGCOUNT,
 COMMENTCODE,
 TRANSFERCODE,
 ADJUSTMENTCODE,
 REGECODE,
 REGDCHECKCODE,
 REGDTRANSFERCODE,
 VOIDCODE,
 SUBACTIONCODE,
 SEQUENCENUMBER,
 EFFECTIVEDATE,
 POSTDATE,
 POSTTIME,
 USERNUMBER,
 USEROVERRIDE,
 SECURITYLEVELS,
 DESCRIPTION,
 ACTIONCODE,
 SOURCECODE,
 BALANCECHANGE,
 INTEREST,
 NEWBALANCE,
 FEEAMOUNT,
 ESCROWAMOUNT,
 LASTTRANDATE,
 MATURITYLOANDUEDATE,
 COMMENT,
 BRANCH,
 CONSOLENUMBER,
 BATCHSEQUENCE,
 SALESTAXAMOUNT,
 ACTIVITYDATE,
 BILLEDFEEAMOUNT,
 PROCESSORUSER,
 MEMBERBRANCH,
 PREVAVAILBALANCE,
 SUBSOURCE,
 CONFIRMATIONSEQ,
 MICRACCTNUM,
 MICRRT,
 RECURRINGTRAN,
 FEEEXMTCRTSYAMT,
 ESCROWUNPAIDBALCHG,
 ESCROWAPPLIEDBALCHG,
 UNAPPLIEDPARTIALPMTCHG,
 FEECOUNTBY,
 LATECHGWAIVEDAMT,
 LATECHGUNPAIDCHGAMT,
 PREVLATECHGDATE,
 PREVLATECHGACCRUED,
 LATECHGFIELDSVALID,
 BALSEGID1,
 BALSEGPMTCHANGEDATE1,
 INTEFFECTDATE,
 BALSEGPREVFIRSTPMTDATE1)
SELECT PARENTACCOUNT,
 PARENTID, 'L' AS CATEGORY,
 BALSEGCOUNT,
 COMMENTCODE,
 TRANSFERCODE,
 ADJUSTMENTCODE,
 REGECODE,
 REGDCHECKCODE,
 REGDTRANSFERCODE,
 VOIDCODE,
 SUBACTIONCODE,
 SEQUENCENUMBER,
 EFFECTIVEDATE,
 POSTDATE,
 POSTTIME,
 USERNUMBER,
 USEROVERRIDE,
 SECURITYLEVELS,
 DESCRIPTION,
 ACTIONCODE,
 SOURCECODE,
 BALANCECHANGE,
 INTEREST,
 NEWBALANCE,
 FEEAMOUNT,
 ESCROWAMOUNT,
 LASTTRANDATE,
 MATURITYLOANDUEDATE,
 COMMENT,
 BRANCH,
 CONSOLENUMBER,
 BATCHSEQUENCE,
 SALESTAXAMOUNT,
 ACTIVITYDATE,
 BILLEDFEEAMOUNT,
 PROCESSORUSER,
 MEMBERBRANCH,
 PREVAVAILBALANCE,
 SUBSOURCE,
 CONFIRMATIONSEQ,
 MICRACCTNUM,
 MICRRT,
 RECURRINGTRAN,
 FEEEXMTCRTSYAMT,
 ESCROWUNPAIDBALCHG,
 ESCROWAPPLIEDBALCHG,
 UNAPPLIEDPARTIALPMTCHG,
 FEECOUNTBY,
 LATECHGWAIVEDAMT,
 LATECHGUNPAIDCHGAMT,
 PREVLATECHGDATE,
 PREVLATECHGACCRUED,
 LATECHGFIELDSVALID,
 BALSEGID1,
 BALSEGPMTCHANGEDATE1,
 INTEFFECTDATE,
 BALSEGPREVFIRSTPMTDATE1
FROM SYM.LOANTRANSACTION;
	


INSERT INTO sym_vault1.Blob_SYM_Transaction(PARENTACCOUNT,
 PARENTID, CATEGORY,
 BALSEGCOUNT,
 COMMENTCODE,
 TRANSFERCODE,
 ADJUSTMENTCODE,
 REGECODE,
 REGDCHECKCODE,
 REGDTRANSFERCODE,
 VOIDCODE,
 SUBACTIONCODE,
 SEQUENCENUMBER,
 EFFECTIVEDATE,
 POSTDATE,
 POSTTIME,
 USERNUMBER,
 USEROVERRIDE,
 SECURITYLEVELS,
 DESCRIPTION,
 ACTIONCODE,
 SOURCECODE,
 BALANCECHANGE,
 INTEREST,
 NEWBALANCE,
 FEEAMOUNT,
 ESCROWAMOUNT,
 LASTTRANDATE,
 MATURITYLOANDUEDATE,
 COMMENT,
 BRANCH,
 CONSOLENUMBER,
 BATCHSEQUENCE,
 SALESTAXAMOUNT,
 ACTIVITYDATE,
 BILLEDFEEAMOUNT,
 PROCESSORUSER,
 MEMBERBRANCH,
 PREVAVAILBALANCE,
 SUBSOURCE,
 CONFIRMATIONSEQ,
 MICRACCTNUM,
 MICRRT,
 RECURRINGTRAN,
 FEEEXMTCRTSYAMT,
 ESCROWUNPAIDBALCHG,
 ESCROWAPPLIEDBALCHG,
 UNAPPLIEDPARTIALPMTCHG,
 FEECOUNTBY,
 LATECHGWAIVEDAMT,
 LATECHGUNPAIDCHGAMT,
 PREVLATECHGDATE,
 PREVLATECHGACCRUED,
 LATECHGFIELDSVALID,
 BALSEGID1,
 BALSEGPMTCHANGEDATE1,
 INTEFFECTDATE,
 BALSEGPREVFIRSTPMTDATE1)
SELECT PARENTACCOUNT,
 PARENTID, 'S' AS CATEGORY,
 BALSEGCOUNT,
 COMMENTCODE,
 TRANSFERCODE,
 ADJUSTMENTCODE,
 REGECODE,
 REGDCHECKCODE,
 REGDTRANSFERCODE,
 VOIDCODE,
 SUBACTIONCODE,
 SEQUENCENUMBER,
 EFFECTIVEDATE,
 POSTDATE,
 POSTTIME,
 USERNUMBER,
 USEROVERRIDE,
 SECURITYLEVELS,
 DESCRIPTION,
 ACTIONCODE,
 SOURCECODE,
 BALANCECHANGE,
 INTEREST,
 NEWBALANCE,
 FEEAMOUNT,
 ESCROWAMOUNT,
 LASTTRANDATE,
 MATURITYLOANDUEDATE,
 COMMENT,
 BRANCH,
 CONSOLENUMBER,
 BATCHSEQUENCE,
 SALESTAXAMOUNT,
 ACTIVITYDATE,
 BILLEDFEEAMOUNT,
 PROCESSORUSER,
 MEMBERBRANCH,
 PREVAVAILBALANCE,
 SUBSOURCE,
 CONFIRMATIONSEQ,
 MICRACCTNUM,
 MICRRT,
 RECURRINGTRAN,
 FEEEXMTCRTSYAMT,
 ESCROWUNPAIDBALCHG,
 ESCROWAPPLIEDBALCHG,
 UNAPPLIEDPARTIALPMTCHG,
 FEECOUNTBY,
 LATECHGWAIVEDAMT,
 LATECHGUNPAIDCHGAMT,
 PREVLATECHGDATE,
 PREVLATECHGACCRUED,
 LATECHGFIELDSVALID,
 BALSEGID1,
 BALSEGPMTCHANGEDATE1,
 INTEFFECTDATE,
 BALSEGPREVFIRSTPMTDATE1
FROM SYM.SAVINGSTRANSACTION;